<%
# Panneau des questionnaires à remplir
%>

<%
#
# SE SERVIR DU CODE CI-DESSOUS POUR CONSTRUIRE LE FORMULAIRE DU
# QUIZ.
#
%>
<% if missing_data %>
<%# Les missing-data, ici, correspondent certainement aux questionnaires en retard. %>
<% end %>

<% if works.count == 0 %>
  <%= message_si_aucun_travail %>
<% elsif has_quiz? %>
  <% quizes.each do |iquiz| %>
    <%= iquiz.output_in_container %>
    <%
      # Si le questionnaire était en correction, c'est qu'il faut
      # maintenant le supprimer. Rappel : Si on le fait avant, il ne
      # se trouverait plus dans la liste des quizes et la version corrigée
      # du questionnaire ne serait donc pas affichée ici.
      #
      # Noter que le work a été créé au moment de l'enregistrement
      # du questionnaire (pour le moment).
      iquiz.mark_work_done if iquiz.correction?
    %>
  <% end %>
<% else %>
  <%# Aucun quiz (mais d'autres travaux) %>
  <p class='big air'>Vous n'avez aucun questionnaire ni aucun quiz à remplir. Mais rassurez-vous, <%= user.pseudo %>, le prochain ne saurait tarder bien longtemps…</p>
  <%
  # TODO Proposer quelques questions quand il n'y a pas de corrections
  %>
<% end %>

<%= bureau.section_unstarted_works(:quiz) %>
<%= bureau.section_undone_works(:quiz) %>
<%= bureau.section_recent_works(:quiz) %>
