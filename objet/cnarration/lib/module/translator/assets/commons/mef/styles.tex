% Définition des styles propres à la série Narration
%

% Police par défaut
\usepackage{times}

% Utiliser "\indentationNormale" pour revenir à l'indentation
% normale définie ici
\newcommand{\indentationNormale}{%
  \setlength{\parindent}{1em}%
}

% \indentationNormale


% Appeler cette commande à la fin d'un environnement pour revenir à
% l'environnement normal
\newcommand{\valeursEnvironnementDefaut}{%
  \indentationNormale%
  \fontfamily{}%
  \selectfont%
}

% Pour mettre un texte en retrait avec N valeurs
% de retrait
\newcommand{\retrait}[2]{
  % #1 = le texte à mettre en retrait
  % #2 = la valeur du retrait, en "unité de marge" (1 à x)
  \noindent
  \setlength{\parindent}{#2em}%
  % \vspace{12pt}\par%
  \begin{minipage}{1\textwidth}
    % \vspace{12pt}%
    #1%
    % \vspace{12pt}%
  \end{minipage}%
  % \vspace{8pt}\par%
  \valeursEnvironnementDefaut%
}


% ---------------------------------------------------------------------
%   Définition des couleurs
% ---------------------------------------------------------------------
\definecolor{fondexemple}{rgb}{0.98,0.98,0.99}
\definecolor{bordexemple}{rgb}{0.7,0.7,0.7}
\definecolor{fondleger}{rgb}{0.99,0.99,0.99}

% ---------------------------------------------------------------------
%   Définition des termes spéciaux
% ---------------------------------------------------------------------
% Voir le fichier "textes_speciaux.tex"

% ---------------------------------------------------------------------
% Mise en forme des références (package varioref)
\labelformat{chapter}{chapitre~#1}
\labelformat{section}{section~#1}
\labelformat{subsection}{sous-section~#1}
\labelformat{table}{le tableau~#1}


% ---------------------------------------------------------------------
%   Divers
% ---------------------------------------------------------------------

\newcommand{\expo}[1]{\textsuperscript{#1}}

% ---------------------------------------------------------------------
%   Styles de boites
% ---------------------------------------------------------------------

% Pour une note dans un cadre
\newcommand{\cadreNote}[1]{%
  \noindent
  \setlength{\parindent}{0em}%
  \vspace{12pt}\par
  \fcolorbox{fondleger}{fondleger}{%
    \begin{minipage}{1\textwidth}
      \vspace{12pt}%
      #1%
      \vspace{12pt}%
    \end{minipage}%
  }
  \vspace{8pt}\par%
  \valeursEnvironnementDefaut%
}

% ---------------------------------------------------------------------
%   Environnements
% ---------------------------------------------------------------------

% Titres à l'intérieur des documents
\newcommand{\titredoc}[2]{
  % TODO: Traiter le nombre d'arguments pour mettre des
  % titre de différents niveaux (à partir de 1)
  % Pour le moment, on met simplement le titre en gras
  {\bfseries #1}
}


% === Main Environnement ===
% L'environnement que doit appeler tout environnement pour un
% document d'écriture en exemple, même de type scénario.
% Cf. les environnements généraux définis ci-dessous.
%
\newcommand{\asDocument}[1]{%
  \noindent
  \setlength{\parindent}{0em}%
  \par
  \fcolorbox{bordexemple}{fondexemple}{%
    \begin{minipage}{1\textwidth}
      \vspace{12pt}
      {#1} %
	\vspace{0pt}%
    \end{minipage}%
  }
  \vspace{16pt}\par%
  % Remettre la config initiale
  \valeursEnvironnementDefaut%
}


% \legend ou \legende
%
% Pour mettre une légende sous un document asDocument
% Noter qu'il ne faut pas mettre cette commande dans l'environnement
% asDocument, mais en dessous :
% @syntax:
%     \asDocument{ ... mon document ... }
%     \legend{Ma légende sous le document précédent}
\newcommand{\legend}[1]{%
	\vspace{-8pt} %
	\hspace{0.25\linewidth} \parbox{0.5\linewidth}{%
	\setstretch{0.5}%
	{\tiny \it #1}%
	}%
	\vspace{12pt}%
}
\newcommand{\legende}[1]{\legend{#1}}


% --- Environnement Scénario ---
% Elle modifie simplement la font et est utilisé
% Par tout environnement scénario
\newcommand{\docScenario}[1]{%
  \fontfamily{phv}
  \selectfont % pour que la font soit prise en compte
  \asDocument{#1}%
}

% --- Environnement Synopsis ---
\newcommand{\docSynopsis}[1]{
  \asDocument{#1}%
}

% --- Environnement évènemencier ---
\newcommand{\docEvenemencier}[1]{
  % Le vspace ci-dessous permet de redescendre le texte
  % qui, pour un évènemencier, est toujours remonté pour
  % réduire artificiellement l'interparagraphe.
  \asDocument{\vspace{12pt} #1}
  % Le vspace ci-dessous permet de remonter le texte qui suit
  % le document.
  \vspace{-1.0em}
}
% Un évènement dans l'évènemencier
\newcommand{\evt}[1]{
\begin{OffText}{1cm}{0pt}%
  \begin{flushleft}%
    % Le vspace ci-dessous est ajouté pour rétrécir l'écartement entre
  	% les paragraphes d'un évènemencier, parce que ça ne fonctionne pas
  	% avec les autres choses que j'ai essayées, à commencer parskip.
    \vspace{-1.0em}
    \hspace{-1.5em}{- }
    \texttt{#1} %
  \end{flushleft} %
\end{OffText}
}

% ---------------------------------------------------------------------
%   Méthodes générales
% ---------------------------------------------------------------------

% Sous-environnement permettant de définir les
% décalage de texte dans tous les autres environnements.
% Notes
%   * Usage : \OffText{<marge gauche>}{<marge droite>}
%   * On peut définir les polices dans l'environnement principal
%     cf. \docScenario ci-dessus
%
\newenvironment{OffText}[2]{%
\begin{list}{}{%
\setlength{\leftmargin}{#1}%
\setlength{\rightmargin}{#2}%
}
\setlength{\parskip}{0pt}%
\indentationNormale%
\scriptsize\item[]%
}{%
\end{list}
}

% ==================================
%		Styles pour les SCÉNARIOS
% ==================================
%
% @usage
%
% 	\docScenario{
%     		\scenarioIntitule{....}
%     		\scenarioAction{....}
%     		\scenarioPersonnage{...}
%     		\scenarioNoteJeu{...}
%     		\scenarioDialogue{...}
% 	}
%
%
% @Notes
%   * Ces commandes sont incluses dans l'environnement \docScenario
%     cf. ci-dessus
% ---------------------------------------------------------------------
\newcommand{\scenarioIntitule}[1]{%
  \begin{OffText}{12pt}{12pt}
    {\bfseries #1}
  \end{OffText}%
}
\newcommand{\scenarioPersonnage}[1]{%
  \begin{OffText}{4cm}{12pt}
    {\bfseries #1}
  \end{OffText}%
}
\newcommand{\scenarioNoteJeu}[1]{%
  \begin{OffText}{4cm}{3cm}
    \vspace{-6pt}
    {\itshape #1}
  \end{OffText}%
}
\newcommand{\scenarioDialogue}[1]{%
  \begin{OffText}{2.5cm}{2cm}
    \begin{flushleft}
      \vspace{-6pt}
      #1
    \end{flushleft}
  \end{OffText}%
}
\newcommand{\scenarioAction}[1]{%
  \begin{OffText}{22pt}{24pt}
    #1
  \end{OffText}%
}
